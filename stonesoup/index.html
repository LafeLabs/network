<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <!--



    -->
    
<link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACe8wAAnHMAAO7vAAD//wAA+D8AAPu/AADauwAAirEAANq7AAD7vwAA8B8AAPx/AADv7wAAnvMAAJxzAAD+/wAA" rel="icon" type="image/x-icon">

    <!--Stop Google:-->
    <META NAME="robots" CONTENT="noindex,nofollow">
</head>
<body>    

<div id = "pagelinkscroll">
    <h1 id = "pagestitle">STONE SOUP</h1>
</div>
<div id = "pagename"></div>
<textarea id = "page"></textarea>

<script>
currentFile = "elements/wizard.txt";
var httpc2 = new XMLHttpRequest();
httpc2.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        filedata = this.responseText;
        document.getElementById("page").value = filedata;
    }
};
httpc2.open("GET", "fileloader.php?filename=" + currentFile, true);
httpc2.send();


pages = [];
var httpc = new XMLHttpRequest();
httpc.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
        pages = JSON.parse(this.responseText);
        for(var index = 0;index < pages.length;index++) {    
            if(pages[index].substring(pages[index].length - 4,pages[index].length) == ".txt"){
             
                var newpagelink = document.createElement("div");
                newpagelink.classList.add("pagelink");
                newpagelink.innerHTML =  pages[index].substring(0,pages[index].length-4);
                document.getElementById("pagelinkscroll").appendChild(newpagelink);
                newpagelink.onclick = function(){
                    currentFile = "elements/" + this.innerHTML + ".txt";
//                    console.log(currentFile);
                    //use php script to load current file;
                    var httpc2 = new XMLHttpRequest();
                    httpc2.onreadystatechange = function() {
                        if (this.readyState == 4 && this.status == 200) {
                            filedata = this.responseText;
                            document.getElementById("page").value = filedata;
                        }
                    };
                    httpc2.open("GET", "fileloader.php?filename=" + currentFile, true);
                    httpc2.send();
                    
//                    document.getElementById("currentfilename").innerHTML = currentFile;
                    
                }
                
            }
        }
        rainbow(document.getElementsByClassName("pagelink"));
    }
};

httpc.open("GET", "dir.php?filename=elements", true);
httpc.send();



document.getElementById("page").onkeyup = function() {
    data = encodeURIComponent(this.value);
    var httpc = new XMLHttpRequest();
    var url = "filesaver.php";        
    httpc.open("POST", url, true);
    httpc.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=utf-8");
    httpc.send("data="+data+"&filename=" + currentFile);//send text to filesaver.php
}

rainbowstring(document.getElementById("pagestitle"));

function rainbowstring(localelement){
    text = localelement.innerHTML;
    localelement.innerHTML = "";
    n = text.length;
    for(var index = 0; index < n; index++){
        var newspan = document.createElement("SPAN");    
        newspan.innerHTML = text.charAt(index);
    
        H = index*360/n;
        z = 255*(1 - Math.abs((H/60)%2 - 1));
    
        if(H < 60){
            red = 255;
            green = Math.round(z);
            blue = 0;
        }
        if(H >= 60 && H < 120){
            red = Math.round(z);
            green = 255;
            blue = 0;
        }
        if(H >= 120 && H < 180){
            red = 0;
            green = 255;
            blue = Math.round(z);
        }
        if(H >= 180 && H < 240){
            red = 0;    
            green = Math.round(z);
            blue = 255;
        }
        if(H >= 240 && H < 300){
            red = Math.round(z);    
            green = 0;
            blue = 255;
        }
        if(H >= 300 && H < 360){
            red = 255;    
            green = 0;
            blue = Math.round(z);
        }
        
        redstring = red.toString(16);
        if(redstring.length < 2){
            redstring = "0" + redstring;    
        }
        greenstring = green.toString(16);
        if(greenstring.length < 2){
            greenstring = "0" + greenstring; 
        }
        bluestring = blue.toString(16);
        if(bluestring.length < 2){
            bluestring = "0" + bluestring; 
        }
        color = "#" + redstring + greenstring + bluestring;   
        newspan.style.color = color;
        localelement.appendChild(newspan);
    }
    

}
function rainbow(localarray){
    n = localarray.length;
    theta = 0;
    for(var index = 0;index < n;index++){
    
        H = index*360/n;
        z = 255*(1 - Math.abs((H/60)%2 - 1));
    
        if(H < 60){
            red = 255;
            green = Math.round(z);
            blue = 0;
        }
        if(H >= 60 && H < 120){
            red = Math.round(z);
            green = 255;
            blue = 0;
        }
        if(H >= 120 && H < 180){
            red = 0;
            green = 255;
            blue = Math.round(z);
        }
        if(H >= 180 && H < 240){
            red = 0;    
            green = Math.round(z);
            blue = 255;
        }
        if(H >= 240 && H < 300){
            red = Math.round(z);    
            green = 0;
            blue = 255;
        }
        if(H >= 300 && H < 360){
            red = 255;    
            green = 0;
            blue = Math.round(z);
        }
        
        redstring = red.toString(16);
        if(redstring.length < 2){
            redstring = "0" + redstring;    
        }
        greenstring = green.toString(16);
        if(greenstring.length < 2){
            greenstring = "0" + greenstring; 
        }
        bluestring = blue.toString(16);
        if(bluestring.length < 2){
            bluestring = "0" + bluestring; 
        }
        color = "#" + redstring + greenstring + bluestring;
        //console.log(color);
        localarray[index].style.backgroundColor = color;// + "80";
        localarray[index].style.borderColor = color;
    }
}

</script>
<style>
body{
    overflow:hidden;
    background-color:black;
}
#qrcode{
    position:absolute;
    left:5px;
    top:5px;
    
}
#page{
    position:absolute;
    width:45%;
    right:1em;
    top:25%;
    bottom:1em;
    background-color:#a0a0a0;
    height:55%;
    font-size:3em;
    font-family:Comic Sans MS;
}
#pagelinkscroll{
    border:solid;
    border-color:#808080;
    border-width:10px;
    position:absolute;
    background-color:#202020;
    left:1em;
    right:55%;
    top:25%;
    bottom:1em;
    overflow:scroll;
}
.pagelink{
    text-align:center;
    font-family:helvetica;
    font-size:3em;
    width:80%;
    margin:auto;
    display:block;
    border:solid;
    border-radius:0.5em;
    border-width:0.5em;
    color:black;
    margin-top:1em;
    margin-bottom:0.5em;
    overflow-x:scroll;
    cursor:pointer;
}
h1{
    text-align:center;
    font-size:4em;
    font-family:Comic Sans MS;
}
#pagename{
    position:absolute;
    right:0px;
    top:0px;
    font-size:2em;
    font-family:Comic Sans MS;
}
@media only screen and (orientation: landscape) {

    
}

@media only screen and (orientation: portrait) {

    
}
</style>
</body>
</html>